<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://www.inflectra.com/Rapise/Maps/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Maps - Rapise Visual Language</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">Rapise Visual Language</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Overview/">About</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../Columns/">Columns</a>
</li>
                                    
<li >
    <a href="../Comments/">Comments</a>
</li>
                                    
<li >
    <a href="../Conditions/">Conditions</a>
</li>
                                    
<li >
    <a href="../Actions/">Actions</a>
</li>
                                    
<li >
    <a href="../Variables/">Variables</a>
</li>
                                    
<li >
    <a href="../Assertions/">Assertions</a>
</li>
                                    
<li >
    <a href="../IfElse/">If-Else</a>
</li>
                                    
<li >
    <a href="../Params/">Parameters</a>
</li>
                                    
<li class="active">
    <a href="./">Maps</a>
</li>
                                    
<li >
    <a href="../Loops/">Loops</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Objects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../RVLObject/">RVL Object</a>
</li>
                                    
<li >
    <a href="../MapObject/">Map Object</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../Params/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../Loops/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="http://www.inflectra.com">Rapise</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#map-definition">Map Definition</a></li>
            <li><a href="#in-place-maps">In-place maps</a></li>
            <li><a href="#external-maps">External maps:</a></li>
        <li class="main "><a href="#using-maps">Using Maps</a></li>
            <li><a href="#reading-in-a-loop">Reading in a Loop</a></li>
        <li class="main "><a href="#maps-types">Maps Types</a></li>
            <li><a href="#rows-map">Rows Map</a></li>
            <li><a href="#columns-map">Columns Map</a></li>
            <li><a href="#table-map">Table Map</a></li>
            <li><a href="#range-map">Range Map</a></li>
            <li><a href="#database-map">Database Map</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>A <em>Map</em> is designed to be an easy way to define tables of data. Items in the map may be accessed by name (if defined) or by index.</p>
<p>The indexed dimensions in the map may also be iterated by the [Loop][Loops.md] function, thus making it useful feature for Data-Driven Testing.</p>
<p><img alt="Map" src="../img/Maps_MapSample.png" /></p>
<p>An RVL script has at least 7 <a href="../Columns/">columns</a>. However the <em>Map</em> may take as many columns as needed.</p>
<h2 id="map-definition">Map Definition</h2>
<p>Typical declaration of map looks like:</p>
<table>
<thead>
<tr>
<th align="left"><em>Flow</em></th>
<th align="left"><em>Type</em></th>
<th align="left"><em>Object</em></th>
<th align="left"><em>Action</em></th>
<th align="left"><em>ParamName</em></th>
<th align="left"><em>ParamType</em></th>
<th align="left"><em>ParamValue</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>Map</em></td>
<td align="left"><code>MapType</code></td>
<td align="left"><strong>MapName</strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">...</td>
<td align="left">...</td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em>End</em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>Where <code>MapType</code> is either inplace: <em>Table</em>, <em>Rows</em>, <em>Columns</em>, or external: <em>Range</em> or <em>Database</em>.</p>
<h3 id="in-place-maps">In-place maps</h3>
<p>In-place map data is defined right in the RVL script. In-place map rows may be selected using <em>This</em> flow or skipped with a <a href="../Comments/">Comment</a>. So in-place maps serve as a part of the executable script.</p>
<ul>
<li><em>Table</em></li>
<li><em>Rows</em></li>
<li><em>Columns</em></li>
</ul>
<h3 id="external-maps">External maps:</h3>
<ul>
<li><em>Range</em></li>
<li><em>Database</em></li>
</ul>
<p>External maps are defined in an external spreadsheet, file or a database.</p>
<h2 id="using-maps">Using Maps</h2>
<p>Once map is defined it may be used as a regular <a href="../MapObject/">Object</a>. </p>
<p><img alt="Map as Object" src="../img/Maps_MapAsObject.png" /></p>
<h3 id="reading-in-a-loop">Reading in a Loop</h3>
<p>See <a href="Loops.md:Map">Loops</a> part for <code>Map</code> type of loops.</p>
<h2 id="maps-types">Maps Types</h2>
<h3 id="rows-map">Rows Map</h3>
<p>A <code>Rows</code> Map is the most useful for data feeds. Each of the set of values is a row in a table that look like:</p>
<table>
<thead>
<tr>
<th align="left"><em>Flow</em></th>
<th align="left"><em>Type</em></th>
<th align="left"><em>Object</em></th>
<th align="left"><em>Action</em></th>
<th align="left"><em>ParamName</em></th>
<th align="left"><em>ParamType</em></th>
<th align="left"><em>ParamValue</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>Map</em></td>
<td align="left"><code>Rows</code></td>
<td align="left"><strong><em>MapName</em></strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Col1</strong></td>
<td align="left"><strong>Col2</strong></td>
<td align="left"><strong>Col3</strong></td>
<td align="left"><strong>Col4</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">val11</td>
<td align="left">val12</td>
<td align="left">val13</td>
<td align="left">val14</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em>End</em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><code>This</code> and comments are specific features of the <code>Rows</code> Map. For example, only the 2nd row of data will be executed in this case:</p>
<table>
<thead>
<tr>
<th align="left"><em>Flow</em></th>
<th align="left"><em>Type</em></th>
<th align="left"><em>Object</em></th>
<th align="left"><em>Action</em></th>
<th align="left"><em>ParamName</em></th>
<th align="left"><em>ParamType</em></th>
<th align="left"><em>ParamValue</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>Map</em></td>
<td align="left"><code>Rows</code></td>
<td align="left"><strong><em>MapName</em></strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Col1</strong></td>
<td align="left"><strong>Col2</strong></td>
<td align="left"><strong>Col3</strong></td>
<td align="left"><strong>Col4</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><strong><em>This</em></strong></td>
<td align="left"><strong><em>...</em></strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em>End</em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><code>Rows</code> are designed to be iterated in a <a href="../Loops/">Loop</a></p>
<p>In real example it looks like this:</p>
<p><img alt="Map" src="../img/Maps_This.png" /></p>
<p><a href="../Comments/">Comments</a> may also be used to skip specific rows or row sets.</p>
<h3 id="columns-map">Columns Map</h3>
<p>A <code>Columns</code> Map is a convenient way for representing data when you have many options combined in few sets. </p>
<table>
<thead>
<tr>
<th align="left"><em>Flow</em></th>
<th align="left"><em>Type</em></th>
<th align="left"><em>Object</em></th>
<th align="left"><em>Action</em></th>
<th align="left"><em>ParamName</em></th>
<th align="left"><em>ParamType</em></th>
<th align="left"><em>ParamValue</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>Map</em></td>
<td align="left"><code>Columns</code></td>
<td align="left"><strong><em>MapName</em></strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row1</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row2</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row3</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em>End</em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>The same may be represented as <code>Rows</code> but would require many columns and sometimes it is harder to read. So columns is ideal for storing configuration structures:</p>
<p><img alt="Columns" src="../img/Maps_Columns.png" /></p>
<p>When a <code>Columns</code> Map is used in the Loop, then the iteration is performed through the columns and addresses the rows by name within the loop. I.e. the 1st iteration chooses 1st column, 2nd goes to 2nd column and so on.</p>
<h3 id="table-map">Table Map</h3>
<p>A Table map has both columns and rows named.</p>
<table>
<thead>
<tr>
<th align="left"><em>Flow</em></th>
<th align="left"><em>Type</em></th>
<th align="left"><em>Object</em></th>
<th align="left"><em>Action</em></th>
<th align="left"><em>ParamName</em></th>
<th align="left"><em>ParamType</em></th>
<th align="left"><em>ParamValue</em></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><em>Map</em></td>
<td align="left"><code>Table</code></td>
<td align="left"><strong><em>MapName</em></strong></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><strong>Col1</strong></td>
<td align="left"><strong>Col2</strong></td>
<td align="left"><strong>Col3</strong></td>
<td align="left"><strong>Col4</strong></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row1</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row2</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><strong>Row3</strong></td>
<td align="left">...</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><em>End</em></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><img alt="Table" src="../img/Maps_Table.png" /></p>
<p>When a <code>Table</code> Map is used in the Loop, then the iteration is performed through the columns and addresses the rows by name within the loop. I.e. 1st iteration chooses 1st column, 2nd goes to 2nd column and so on.</p>
<p>It is convenient to use a <code>Table</code> Map when you have several columns and many rows so it perfectly fits into the screen. For example you may have several alternative configuration sections and want to use them depending on the situation. In the example below we have several sites (Testing, QA, Prod) each having own Url, Login etc. So we want to quickly switch between sites when working with test.</p>
<p><img alt="Table Config Columns" src="../img/Maps_TableColumns.png" /></p>
<h3 id="range-map">Range Map</h3>
<p><code>Range</code> map contains no in-place data, but defines a region in the external spreadsheet to read information from.</p>
<p><img alt="Range Map" src="../img/Maps_Range.png" /></p>
<p>A <code>Range</code> map definition contains a number of required parameters:</p>
<ul>
<li><em>fileName</em> Path to file containing data.  It may point to .xls, .xlsx or .csv file. If when it is empty we assume that data is stored in the same .rvl.xls spreadsheet as the script. </li>
<li><em>sheetName</em> Excel Sheet name. May be empty for .csv spreadsheets.</li>
<li><em>fromRow</em> 0-based index of the first row containing data. Usually first row is assigned as a header containing column names.</li>
<li><em>fromCol</em> 0-based index of the first column containing data.</li>
<li><em>toRow</em> final row index. If set to -1 then final row is detected automatically (as last row containing some data in the 1st column)</li>
<li><em>toCol</em> final column index. If set to -1 then final column is detected automatically as last column containing data in the 1st row.</li>
</ul>
<p>Also there is a hidden parameter:</p>
<ul>
<li><em>hasColumnNames</em> boolean. By default it is <code>true</code> meaning that 1st rows is assumed to contain column names. Once it is <code>false</code> the columns will have no names and may only be accessed by 0-based index.</li>
</ul>
<p>Data in the <code>Range</code> map is assumed to be similar to <a href="#rows-map"><code>Rows</code></a> map, but defined externally. Looping is done by rows. Typical external file containing data may look like that:</p>
<p><img alt="Range Data" src="../img/Maps_RangeData.png" /></p>
<h3 id="database-map">Database Map</h3>
<p>A <code>Database</code> map contains no in-place data, but defines a connection to the database result set. </p>
<p><img alt="Database Map" src="../img/Maps_Database.png" /></p>
<p>The <code>Database</code> map definition contains two parameters:</p>
<ul>
<li><em>connectionString</em> ADO connection string. </li>
<li><em>query</em> usually it is an SQL query to execute.</li>
</ul>
<p><em>connectionString</em> parameter allows accessing wide variety of different database sources. You may learn ore here: <a href="https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/connectionstring-property-ado">https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/connectionstring-property-ado</a>.</p>
<p>Some samples of typical ADO connection string values:</p>
<h4 id="microsoft-access">Microsoft Access</h4>
<pre><code>Provider=MSDASQL; Driver={Microsoft Access Driver (*.mdb)}; DBQ=C:\path\filename.mdb;
</code></pre>
<h4 id="microsoft-excel">Microsoft Excel</h4>
<pre><code>Provider=MSDASQL; Driver={Microsoft Excel Driver (*.xls)}; DBQ=C:\path\filename.xls;
</code></pre>
<h4 id="microsoft-text">Microsoft Text</h4>
<pre><code>Provider=MSDASQL; Driver={Microsoft Text Driver (*.txt; *.csv)}; DBQ=C:\path\;
</code></pre>
<p>An example below refers to ODBC Data Source defined as follows:</p>
<p><img alt="Database ODBC data source" src="../img/Maps_DatabaseODBC.png" /></p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright © 2007-2017, All Rights Reserved, Inflectra Corporation</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"search": 83, "next": 78, "previous": 80, "help": 191};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
